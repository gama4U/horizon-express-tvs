generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                    String                 @id @default(cuid())
  firstName             String
  lastName              String
  email                 String                 @unique
  password              String
  avatar                String?
  userType              UserType
  createdAt             DateTime               @default(now())
  updatedAt             DateTime               @updatedAt
  transactions          Transaction[]
  salesAgreements       SalesAgreement[]
  purchaseRequestOrders PurchaseRequestOrder[]
}

model Transaction {
  id                   String                @id @default(cuid())
  userId               String
  lead                 User                  @relation(fields: [userId], references: [id])
  travelVoucher        Travel?
  accommodationVoucher Accommodation?
  tourVoucher          Tour?
  transportVoucher     Transportation?
  salesAgreement       SalesAgreement?
  purchaseOrder        PurchaseRequestOrder?
  createdAt            DateTime?             @default(now())
  updatedAt            DateTime?             @updatedAt
}

model SalesAgreement {
  id                 String                @id @default(cuid())
  transactionId      String                @unique
  transaction        Transaction           @relation(fields: [transactionId], references: [id])
  purchaseOrder      PurchaseRequestOrder?
  typeOfClient       ClientType
  clientName         String?
  preparedBy         String?
  approvedBy         String?
  SalesAgreementItem SalesAgreementItem[]

  creatorId String
  creator   User      @relation(fields: [creatorId], references: [id])
  createdAt DateTime? @default(now())
  updatedAt DateTime? @updatedAt
}

model SalesAgreementItem {
  id               String         @id @default(cuid())
  particulars      String?
  quantity         Int?
  unitPrice        Float?
  total            Float?
  salesAgreementId String
  salesAgreement   SalesAgreement @relation(fields: [salesAgreementId], references: [id])

  createdAt DateTime? @default(now())
  updatedAt DateTime? @updatedAt
}

model PurchaseRequestOrder {
  id                String                     @id @default(cuid())
  suppliersName     String?
  expenses          String?
  other             String?
  transactionId     String                     @unique
  transaction       Transaction                @relation(fields: [transactionId], references: [id])
  purchaseOrderItem PurchaseRequestOrderItem[]
  type              PurchaseRequestOrderType?
  paymentType       PaymentType?
  creatorId         String?
  creator           User?                      @relation(fields: [creatorId], references: [id])
  nos               String?

  salesAgreementNumber String         @unique
  salesAgreement       SalesAgreement @relation(fields: [salesAgreementNumber], references: [id])

  createdAt DateTime? @default(now())
  updatedAt DateTime? @updatedAt
}

model PurchaseRequestOrderItem {
  id                     String               @id @default(cuid())
  purchaseRequestOrderId String
  purchaseRequestOrder   PurchaseRequestOrder @relation(fields: [purchaseRequestOrderId], references: [id])
  particulars            String?
  quantity               Int?
  unitPrice              Float?
  total                  Float?

  createdAt DateTime? @default(now())
  updatedAt DateTime? @updatedAt
}

model Travel {
  id            String       @id @default(cuid())
  transactionId String?      @unique
  transaction   Transaction? @relation(fields: [transactionId], references: [id])
  type          TravelType
  airline       Airlines?
  shipping      Shipping?
  createdAt     DateTime?    @default(now())
  updatedAt     DateTime?    @updatedAt
}

model Airlines {
  id          String    @id @default(cuid())
  name        String
  code        String
  etd         DateTime
  eta         DateTime
  origin      String
  travelId    String?   @unique
  travel      Travel?   @relation(fields: [travelId], references: [id])
  destination String
  createdAt   DateTime? @default(now())
  updatedAt   DateTime? @updatedAt
}

model Shipping {
  id           String   @id @default(cuid())
  name         String
  voyageNumber String
  dateOfTravel DateTime
  origin       String
  destination  String
  travelId     String?  @unique
  travel       Travel?  @relation(fields: [travelId], references: [id])
}

model Accommodation {
  id                      String            @id @default(cuid())
  transactionId           String?           @unique
  transaction             Transaction?      @relation(fields: [transactionId], references: [id])
  type                    AccommodationType
  name                    String
  checkinDate             DateTime
  checkoutDate            DateTime
  hotelConfirmationNumber String
  remarks                 String?
  createdAt               DateTime?         @default(now())
  updatedAt               DateTime?         @updatedAt
}

model Tour {
  id            String       @id @default(cuid())
  transactionId String?      @unique
  transaction   Transaction? @relation(fields: [transactionId], references: [id])
  itinerary     Itinerary[]
  remarks       String?
  driverName    String
  driverContact String
  createdAt     DateTime?    @default(now())
  updatedAt     DateTime?    @updatedAt
}

model Itinerary {
  id          String         @id @default(cuid())
  tourId      String
  tour        Tour           @relation(fields: [tourId], references: [id])
  transportId String
  transport   Transportation @relation(fields: [transportId], references: [id])

  title       String
  description String
  startDate   DateTime
  endDate     DateTime

  createdAt DateTime? @default(now())
  updatedAt DateTime? @updatedAt
}

model Transportation {
  id                 String               @id @default(cuid())
  transactionId      String?              @unique
  transaction        Transaction?         @relation(fields: [transactionId], references: [id])
  serviceType        TransportServiceType
  driverName         String
  driverContact      String
  remarks            String?
  vehicleType        VehicleType
  vehiclePlateNumber String
  itinerary          Itinerary[]
  createdAt          DateTime             @default(now())
  updatedAt          DateTime             @updatedAt
}

enum UserType {
  ADMIN
  EMPLOYEE
}

enum ClientType {
  WALK_IN
  CORPORATE
  GOVERNMENT
}

enum PurchaseRequestOrderType {
  TICKET
  LOCAL_PACKAGE
  INTERNATIONAL_PACKAGE
  HOTEL
  VISA
}

enum PaymentType {
  CASH
  CHECK
}

enum TransportServiceType {
  PUDO
  WHOLE_DAY
  HALF_DAY
  MULTIPLE
}

enum VehicleType {
  VAN
  SUV
  COASTER
  SEDAN
  BUS
}

enum TravelType {
  AIRLINES
  SHIPPING
}

enum AccommodationType {
  HOTEL
  RESORT
  AIRBNB
  OTHERS
}
